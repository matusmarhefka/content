---
policy: 'Indian Telecom Security Assurance Requirements (ITSAR) - NFV Security'
title: 'ITSAR NFV Security - Chapter 2 Common Security Requirements'
id: itsar
version: '1.0.0'
source: 'ITSAR404042308 - Network Function Virtualization (NFV)'
reference_type: itsar
product: rhel9

levels:
    - id: base

controls:
    # Section 1: Access and Authorization
    - id: 2.1.1
      title: Management Protocols Mutual Authentication
      levels:
          - base
      description: |-
          The system management shall support mutual authentication mechanisms, the mutual
          authentication mechanism can rely on the protocol used for the interface itself or other
          means. Secure cryptographic controls prescribed in Table1 of the latest document
          "Cryptographic Controls For Indian Telecom Security Assurance Requirements (ITSAR)"
          shall only be used for management and maintenance.
      status: automated
      rules:
          - sshd_enable_pubkey_auth
          - sshd_enable_pam
          - configure_ssh_crypto_policy
          - configure_crypto_policy

    - id: 2.1.2
      title: Management Traffic Protection
      levels:
          - base
      description: |-
          The management traffic shall be protected strictly using secure cryptographic controls
          prescribed in Table1 of the latest document "Cryptographic Controls For Indian Telecom
          Security Assurance Requirements (ITSAR)" only.
      status: automated
      rules:
          - configure_crypto_policy
          - configure_ssh_crypto_policy
          - configure_openssl_crypto_policy
          - sshd_use_approved_ciphers
          - sshd_approved_ciphers=stig_rhel9
          - sshd_use_strong_kex

    - id: 2.1.3
      title: Role-based access control policy
      levels:
          - base
      description: |-
          The system shall support Role-Based Access Control (RBAC). A role-based access control
          system uses a set of controls that determines how users interact with domains and
          resources. The RBAC system controls how users or groups of users are allowed access to
          the various domains and what type of operation they can perform.
      status: partial
      notes: |-
          RBAC is partially implemented through Linux user groups and file permissions. Full RBAC
          implementation would require additional access control frameworks like SELinux policies
          or custom RBAC systems.
      rules:
          - selinux_state
          - var_selinux_state=enforcing
          - selinux_policytype
      related_rules:
          - selinux_confinement_of_daemons
          - selinux_not_disabled

    - id: 2.1.4
      title: User Authentication - Local/Remote
      levels:
          - base
      description: |-
          The various user and machine accounts on a system shall be protected from misuse.
          Authentication attributes include cryptographic keys, token, and passwords.
          Minimum two of the above Authentication attributes shall be mandatorily combined for
          protecting all the accounts from misuse. An exception to this requirement is local access
          and machine accounts where at least one authentication attribute shall be supported.
      status: partial
      notes: |-
          Multi-factor authentication typically requires additional configuration beyond basic OS
          settings. Two-factor authentication with SSH keys and passwords can be configured.
      rules:
          - sshd_enable_pubkey_auth
          - sshd_enable_pam
      related_rules:
          - package_pam_pwquality_installed

    - id: 2.1.5
      title: Remote login restrictions for privileged users
      levels:
          - base
      description: |-
          Login to system as root or equivalent highest privileged user shall be limited to the
          system console only. Root user will not be allowed to login remotely.
      status: automated
      rules:
          - sshd_disable_root_login
          - no_direct_root_logins
          - securetty_root_login_console_only

    - id: 2.1.6
      title: Authorization Policy
      levels:
          - base
      description: |-
          The authorizations for accounts and applications shall be reduced to the minimum required
          for the tasks they have to perform. Authorizations to a system shall be restricted to a
          level in which a user can only access data and use functions that he needs in the course
          of his work.
      status: manual
      notes: |-
          This is a policy-based requirement that must be implemented by the system administrator
          according to organizational needs. File permissions and SELinux policies help enforce this.
      related_rules:
          - selinux_state
          - file_permissions_unauthorized_world_writable

    - id: 2.1.7
      title: Unambiguous identification of the user & group accounts removal
      levels:
          - base
      description: |-
          Users shall be identified unambiguously by the system. System shall support the
          assignment of individual accounts per user. System shall not enable the use of group
          accounts or group credentials, or sharing of the same account between several users.
      status: automated
      rules:
          - accounts_no_uid_except_zero
          - account_unique_id
          - account_unique_name
          - group_unique_id
          - group_unique_name

    - id: 2.1.8
      title: Out of band Management
      levels:
          - base
      description: |-
          Management interfaces shall be secured from remote access through Out-of-band
          management network that is not accessible from the internet. Multi-factor authentication
          (MFA) shall be used for remote access through VPN.
      status: manual
      notes: |-
          Out-of-band management network configuration is infrastructure-specific and must be
          implemented at the network level.

    # Section 2: Authentication Attribute Management
    - id: 2.2.1
      title: Authentication Policy
      levels:
          - base
      description: |-
          The usage of a system function without successful authentication on basis of the user
          identity and at least two authentication attributes (e.g. password, certificate) shall be
          prevented. For machine accounts and local access one authentication attribute will be
          sufficient.
      status: partial
      notes: |-
          Basic authentication is enforced. Multi-factor authentication requires additional
          configuration.
      rules:
          - sshd_enable_pam
          - no_empty_passwords
          - no_empty_passwords_etc_shadow

    - id: 2.2.2
      title: Authentication Support - External
      levels:
          - base
      description: |-
          If the system supports external authentication mechanism such as AAA server then the
          communication between system and the external authentication entity shall be protected
          using the authentication and related service protocols built strictly using the Secure
          cryptographic controls.
      status: partial
      notes: |-
          System supports external authentication via PAM. Cryptographic protection of connections
          to external auth servers depends on the specific authentication mechanism used (LDAP,
          Kerberos, etc.).
      related_rules:
          - configure_crypto_policy
          - configure_kerberos_crypto_policy

    - id: 2.2.3
      title: Protection against brute force and dictionary attacks
      levels:
          - base
      description: |-
          A protection against brute force and dictionary attacks that hinder authentication
          attribute guessing shall be implemented in system. Various measures include timer delay,
          account blocking, authentication attribute blacklist, and CAPTCHA.
      status: automated
      rules:
          - accounts_passwords_pam_faillock_deny
          - var_accounts_passwords_pam_faillock_deny=5
          - accounts_passwords_pam_faillock_interval
          - var_accounts_passwords_pam_faillock_fail_interval=900
          - accounts_passwords_pam_faillock_unlock_time
          - var_accounts_passwords_pam_faillock_unlock_time=900

    - id: 2.2.4
      title: Enforce Strong Password
      levels:
          - base
      description: |-
          The configuration setting shall be such that a system shall only accept passwords that
          comply with the following complexity criteria:
          - Absolute minimum length of 8 characters
          - Password shall mandatorily comprise all the following four categories:
            at least 1 uppercase character (A-Z)
            at least 1 lowercase character (a-z)
            at least 1 digit (0-9)
            at least 1 special character
          - Password shall not be stored in clear text; passwords shall be salted and hashed.
      status: automated
      rules:
          - accounts_password_pam_minlen
          - var_password_pam_minlen=8
          - accounts_password_pam_ucredit
          - var_password_pam_ucredit=1
          - accounts_password_pam_lcredit
          - var_password_pam_lcredit=1
          - accounts_password_pam_dcredit
          - var_password_pam_dcredit=1
          - accounts_password_pam_ocredit
          - var_password_pam_ocredit=1
          - accounts_password_pam_minclass
          - var_password_pam_minclass=4
          - set_password_hashing_algorithm_systemauth
          - set_password_hashing_algorithm_passwordauth
          - var_password_hashing_algorithm_pam=sha512

    - id: 2.2.5
      title: Inactive Session timeout
      levels:
          - base
      description: |-
          An OAM user interactive session shall be terminated automatically after a specified
          period of inactivity. It shall be possible to configure an inactivity time-out period.
          Reauthentication of the OAM user shall be repeated following any period of inactivity
          lasting 15 minutes or longer.
      status: automated
      rules:
          - accounts_tmout
          - var_accounts_tmout=15_min
          - sshd_set_idle_timeout
          - sshd_idle_timeout_value=15_minutes
          - sshd_set_keepalive

    - id: 2.2.6
      title: Password Changes
      levels:
          - base
      description: |-
          If a password is used as an authentication attribute, then the system shall offer a
          function that enables a user to change his password at any time. Password change shall be
          enforced after initial login. System shall enforce password change based on password
          management policy. System shall enforce password expiry. Previously used passwords shall
          not be allowed up to a certain number (Password History). The minimum password age shall
          be set as one day.
      status: automated
      rules:
          - accounts_password_pam_pwhistory_remember_password_auth
          - accounts_password_pam_pwhistory_remember_system_auth
          - var_password_pam_remember=3
          - accounts_maximum_age_login_defs
          - var_accounts_maximum_age_login_defs=90
          - accounts_minimum_age_login_defs
          - var_accounts_minimum_age_login_defs=1
          - accounts_password_warn_age_login_defs
          - var_accounts_password_warn_age_login_defs=7

    - id: 2.2.7
      title: Protected Authentication feedback
      levels:
          - base
      description: |-
          The Authentication attribute shall not be displayed in such a way that it could be seen
          and misused by a casual local observer. Typically, the individual characters of the
          password are replaced by a character such as "*".
      status: inherently met
      notes: |-
          This is inherently met by PAM and SSH implementations which mask password input by default.

    - id: 2.2.8
      title: Removal of predefined or default authentication attributes
      levels:
          - base
      description: |-
          Predefined or default authentication attributes shall be deleted or disabled (or changed).
          Such authentication attributes shall be changed by automatically forcing a user to change
          it on 1st time login to the system.
      status: partial
      notes: |-
          System does not have predefined default passwords, but forcing password change on first
          login requires additional PAM configuration.
      related_rules:
          - accounts_password_pam_pwhistory_remember_password_auth
          - accounts_password_pam_pwhistory_remember_system_auth

    - id: 2.2.9
      title: Logout function
      levels:
          - base
      description: |-
          The system shall have a function that allows a signed-in user to logout at any time. All
          processes under the logged-in user ID shall be terminated on logout.
      status: inherently met
      notes: |-
          Standard logout functionality is provided by the operating system.

    - id: 2.2.10
      title: Policy regarding consecutive failed login attempts
      levels:
          - base
      description: |-
          The maximum permissible number of consecutive failed user account login attempts shall be
          configurable by the operator. The default value shall be less than or equal to 8,
          typically 5. After the maximum is exceeded, there shall be a block delay.
      status: automated
      rules:
          - accounts_passwords_pam_faillock_deny
          - var_accounts_passwords_pam_faillock_deny=5
          - accounts_passwords_pam_faillock_unlock_time
          - var_accounts_passwords_pam_faillock_unlock_time=900

    - id: 2.2.11
      title: Suspend accounts on non-use
      levels:
          - base
      description: |-
          It shall be possible for the system to automatically suspend an account after 'X' days
          without a valid login.
      status: automated
      rules:
          - account_disable_post_pw_expiration
          - var_account_disable_post_pw_expiration=35

    # Section 3: Software Security
    - id: 2.3.1
      title: Secure Update
      levels:
          - base
      description: |-
          For software updates, the system shall support software package integrity validation via
          cryptographic means, e.g. digital signature, code signing certificate (valid and not time
          expired).
      status: automated
      rules:
          - ensure_gpgcheck_globally_activated
          - ensure_gpgcheck_never_disabled
          - ensure_redhat_gpgkey_installed

    - id: 2.3.2
      title: Secure Upgrade
      levels:
          - base
      description: |-
          The system's Software package integrity shall be validated in the installation/upgrade
          stage. Tampered software shall not be executed or installed if the integrity check fails.
      status: automated
      rules:
          - ensure_gpgcheck_globally_activated
          - ensure_gpgcheck_never_disabled
          - rpm_verify_permissions
          - rpm_verify_ownership

    - id: 2.3.3
      title: Source code security assurance
      levels:
          - base
      description: |-
          OEM shall follow best security practices including secure coding for software development.
          System software shall be free from CWE top 25, OWASP top 10 security vulnerabilities.
      status: manual
      notes: |-
          This requirement is for OEM/vendor compliance and cannot be automated through system
          configuration.

    - id: 2.3.4
      title: Known Malware and backdoor Check
      levels:
          - base
      description: |-
          OEM shall submit an undertaking stating that the system is free from all known malware
          and backdoors.
      status: manual
      notes: |-
          This is an OEM/vendor compliance requirement.

    - id: 2.3.5
      title: No unused software
      levels:
          - base
      description: |-
          Software components or parts of software which are not needed for operation or
          functionality of the system shall not be present. Orphaned software components/packages
          shall not be present in system.
      status: manual
      notes: |-
          Identifying unused software requires understanding of the specific system purpose and
          functionality. Administrators should regularly audit installed packages.
      related_rules:
          - package_aide_installed

    - id: 2.3.6
      title: Unnecessary Services Removal
      levels:
          - base
      description: |-
          The system shall only run protocol handlers and services which are needed for its
          operation. By default, all other ports and services will be permanently disabled. The
          system shall not support FTP, TFTP, Telnet, rlogin, RCP, RSH, HTTP, SNMPv1 and v2, SSHv1,
          TCP/UDP Small Servers, Finger, BOOTP server, Discovery protocols, IP Identification
          Service, and PAD.
      status: automated
      rules:
          - package_telnet-server_removed
          - package_telnet_removed
          - service_telnet_disabled
          - package_rsh-server_removed
          - package_rsh_removed
          - service_rlogin_disabled
          - package_vsftpd_removed
          - service_vsftpd_disabled
          - package_tftp-server_removed
          - package_tftp_removed

    - id: 2.3.7
      title: Restricting System Boot Source
      levels:
          - base
      description: |-
          The system can boot only from the memory devices intended for this purpose.
      status: manual
      notes: |-
          Boot device restrictions are typically configured in BIOS/UEFI settings.
      related_rules:
          - grub2_password
          - grub2_uefi_password

    - id: 2.3.8
      title: Secure Time Synchronization
      levels:
          - base
      description: |-
          The reliable time and date information shall be provided through NTP/PTP server. All
          elements/functions which require time stamp shall establish secure communication channel
          with NTP/PTP server. Audit logs shall be generated for all changes to time settings.
      status: automated
      rules:
          - package_chrony_installed
          - service_chronyd_enabled
          - chronyd_specify_remote_server
          - chronyd_run_as_chrony_user
      related_rules:
          - chronyd_client_only
          - chronyd_no_chronyc_network

    - id: 2.3.9
      title: Restricted reachability of services
      levels:
          - base
      description: |-
          The system shall restrict the reachability of services such that they can be reached only
          on interfaces meant for the purpose. Administrative services shall be restricted to
          interfaces in the management plane for separation of management traffic from user traffic.
      status: partial
      notes: |-
          This requires firewall configuration and network interface management.
      rules:
          - service_firewalld_enabled
          - firewalld_loopback_traffic_trusted
      related_rules:
          - configure_firewalld_ports

    - id: 2.3.10
      title: Self Testing
      levels:
          - base
      description: |-
          A cryptographic module shall perform power-up self-tests and conditional self-tests to
          ensure that the module is functioning properly.
      status: partial
      notes: |-
          FIPS mode enables cryptographic self-tests. Full implementation requires FIPS-certified
          cryptographic modules.
      related_rules:
          - package_dracut-fips_installed

    # Section 4: System Secure Execution Environment
    - id: 2.4.1
      title: No unused functions
      levels:
          - base
      description: |-
          Unused functions i.e the software and hardware functions which are not needed for
          operation or functionality of the system shall be deactivated in the system's software
          and/or hardware.
      status: manual
      notes: |-
          Requires system-specific analysis to identify unused functions.

    - id: 2.4.2
      title: No unsupported components
      levels:
          - base
      description: |-
          OEM to ensure that the system shall not contain software and hardware components that are
          no longer supported, such as components that have reached end-of-life or end-of-support.
      status: manual
      notes: |-
          This is primarily an operational requirement requiring regular audits of installed
          components against vendor support lifecycles.

    - id: 2.4.3
      title: Avoidance of Unspecified mode of Access
      levels:
          - base
      description: |-
          System shall not contain any wireless access mechanism which is unspecified or not
          declared.
      status: automated
      rules:
          - wireless_disable_interfaces
          - service_bluetooth_disabled
      related_rules:
          - kernel_module_bluetooth_disabled

    # Section 5: User Audit
    - id: 2.5.1
      title: Audit trail storage and protection
      levels:
          - base
      description: |-
          The security event log shall be access controlled (file access rights) such that only
          privilege users have access to the log files.
      status: automated
      rules:
          - file_permissions_var_log_audit
          - file_group_ownership_var_log_audit
          - directory_permissions_var_log_audit

    - id: 2.5.2
      title: Audit Event Generation
      levels:
          - base
      description: |-
          The system shall log all important Security events. System shall record within each audit
          record at least information pertaining to Date and time of the event, type of event,
          subject identity, protocol, service or program used for access, source and destination IP
          addresses & ports and the outcome (success or failure) of the event.
      status: automated
      rules:
          - package_audit_installed
          - package_audit-libs_installed
          - service_auditd_enabled
          - grub2_audit_argument
          - grub2_audit_backlog_limit_argument
          - audit_rules_sysadmin_actions
          - audit_rules_suid_auid_privilege_function
          - audit_sudo_log_events
          - audit_rules_time_adjtimex
          - audit_rules_time_settimeofday
          - audit_rules_time_clock_settime
          - audit_rules_time_watch_localtime
          - audit_rules_networkconfig_modification
          - audit_rules_usergroup_modification_group
          - audit_rules_usergroup_modification_gshadow
          - audit_rules_usergroup_modification_passwd
          - audit_rules_usergroup_modification_shadow
          - audit_rules_dac_modification_chmod
          - audit_rules_dac_modification_chown
          - audit_rules_dac_modification_fchmod
          - audit_rules_dac_modification_fchown
          - audit_rules_login_events_faillock
          - audit_rules_login_events_lastlog
          - audit_rules_session_events_utmp
          - audit_rules_session_events_btmp
          - audit_rules_session_events_wtmp
          - audit_rules_privileged_commands
          - audit_rules_kernel_module_loading_init
          - audit_rules_kernel_module_loading_delete
          - audit_rules_immutable

    - id: 2.5.3
      title: Secure Log Export
      levels:
          - base
      description: |-
          The system shall support forwarding of security event logging data to an external system
          by push or pull mechanism through redundant links. The system shall be able to store the
          generated audit data locally for at least two days.
      status: partial
      notes: |-
          Audit log forwarding requires configuring remote syslog or audit log shipping. Local
          storage capacity depends on system configuration.
      rules:
          - auditd_data_retention_max_log_file
          - var_auditd_max_log_file=6
          - auditd_data_retention_max_log_file_action
          - var_auditd_max_log_file_action=keep_logs
      related_rules:
          - rsyslog_remote_loghost
          - package_rsyslog_installed

    - id: 2.5.4
      title: Logging access to personal data
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement logging of all access to personal data with details
          about who accessed what data and when.

    - id: 2.5.5
      title: Security audit log
      levels:
          - base
      description: |-
          Logs shall provide comprehensive security audit trail including timestamp, event source,
          event type, user identity, and outcome.
      status: automated
      notes: |-
          Covered by audit rules in 2.5.2
      related_rules:
          - audit_rules_sysadmin_actions

    - id: 2.5.6
      title: Audit Logs
      levels:
          - base
      description: |-
          System shall maintain comprehensive audit logs for security events.
      status: automated
      notes: |-
          Covered by audit rules in 2.5.2
      related_rules:
          - service_auditd_enabled

    - id: 2.5.7
      title: Centralized log Auditing
      levels:
          - base
      description: |-
          System shall support forwarding logs to centralized log management system.
      status: partial
      notes: |-
          Requires configuration of remote log server.
      related_rules:
          - rsyslog_remote_loghost
          - package_rsyslog_installed

    # Section 6: Data Protection
    - id: 2.6.1
      title: Cryptographic Based Secure Communication
      levels:
          - base
      description: |-
          All communication channels shall use cryptographic protection using approved algorithms.
      status: automated
      rules:
          - configure_crypto_policy
          - var_system_crypto_policy=fips
          - configure_ssh_crypto_policy
          - configure_openssl_crypto_policy
          - sshd_use_approved_ciphers
          - sshd_approved_ciphers=stig_rhel9
          - sshd_use_strong_kex

    - id: 2.6.2
      title: Cryptographic Module Security Assurance
      levels:
          - base
      description: |-
          Cryptographic modules shall be properly validated and certified.
      status: partial
      notes: |-
          FIPS mode provides FIPS 140-2 validated cryptographic modules when enabled.
      related_rules:
          - package_dracut-fips_installed

    - id: 2.6.3
      title: Cryptographic Algorithms implementation Security Assurance
      levels:
          - base
      description: |-
          Only approved cryptographic algorithms shall be used.
      status: automated
      rules:
          - configure_crypto_policy
          - var_system_crypto_policy=fips
          - sshd_use_approved_ciphers
          - sshd_approved_ciphers=stig_rhel9

    - id: 2.6.4
      title: Protecting data and information - Confidential System Internal Data
      levels:
          - base
      description: |-
          Confidential system internal data shall be protected from unauthorized access.
      status: automated
      rules:
          - file_permissions_etc_shadow
          - file_permissions_etc_gshadow
          - file_owner_etc_shadow
          - file_owner_etc_gshadow
          - file_groupowner_etc_shadow
          - file_groupowner_etc_gshadow
      related_rules:
          - file_permissions_unauthorized_world_writable

    - id: 2.6.5
      title: Protecting data and information in storage
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement encryption for data at rest. Consider using LUKS for
          disk encryption or filesystem-level encryption.

    - id: 2.6.6
      title: Protection against Copy of Data
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement controls to prevent unauthorized copying of sensitive
          data. This may include DLP (Data Loss Prevention) solutions and access controls.

    - id: 2.6.7
      title: Protection against Data Exfiltration - Overt Channel
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement monitoring and blocking of unauthorized data transfers
          through network channels, USB devices, and other overt channels.

    - id: 2.6.8
      title: Protection against Data Exfiltration - Covert Channel
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement controls to detect and prevent covert channel
          communications. This is a complex requirement that may need specialized security tools.

    # Section 7: Network Services
    - id: 2.7.1
      title: Traffic Filtering - Network Level
      levels:
          - base
      description: |-
          Network traffic shall be filtered based on source, destination, and protocol.
      status: automated
      rules:
          - service_firewalld_enabled
          - package_firewalld_installed
          - set_firewalld_default_zone
      related_rules:
          - configure_firewalld_ports
          - firewalld_loopback_traffic_trusted

    - id: 2.7.2
      title: Traffic Separation
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement network segmentation to separate management traffic,
          user traffic, and other traffic types. This typically requires VLAN configuration and
          network infrastructure setup.

    - id: 2.7.3
      title: Traffic Protection - Anti-Spoofing
      levels:
          - base
      description: |-
          System shall protect against IP spoofing attacks.
      status: automated
      rules:
          - sysctl_net_ipv4_conf_all_rp_filter
          - sysctl_net_ipv4_conf_all_rp_filter_value=enabled
          - sysctl_net_ipv4_conf_default_rp_filter
          - sysctl_net_ipv4_conf_default_rp_filter_value=enabled

    - id: 2.7.4
      title: Network security
      levels:
          - base
      description: |-
          Various network security controls shall be implemented including disabling IP forwarding,
          source routing, ICMP redirects, and enabling SYN cookies.
      status: automated
      rules:
          - sysctl_net_ipv4_ip_forward
          - sysctl_net_ipv4_conf_all_accept_source_route
          - sysctl_net_ipv4_conf_all_accept_source_route_value=disabled
          - sysctl_net_ipv4_conf_default_accept_source_route
          - sysctl_net_ipv4_conf_default_accept_source_route_value=disabled
          - sysctl_net_ipv4_conf_all_accept_redirects
          - sysctl_net_ipv4_conf_all_accept_redirects_value=disabled
          - sysctl_net_ipv4_conf_default_accept_redirects
          - sysctl_net_ipv4_conf_default_accept_redirects_value=disabled
          - sysctl_net_ipv4_conf_all_secure_redirects
          - sysctl_net_ipv4_conf_all_secure_redirects_value=disabled
          - sysctl_net_ipv4_conf_default_secure_redirects
          - sysctl_net_ipv4_conf_default_secure_redirects_value=disabled
          - sysctl_net_ipv4_conf_all_send_redirects
          - sysctl_net_ipv4_conf_default_send_redirects
          - sysctl_net_ipv4_tcp_syncookies
          - sysctl_net_ipv4_tcp_syncookies_value=enabled
          - sysctl_net_ipv4_conf_all_log_martians
          - sysctl_net_ipv4_conf_all_log_martians_value=enabled
          - sysctl_net_ipv4_conf_default_log_martians
          - sysctl_net_ipv4_conf_default_log_martians_value=enabled
          - sysctl_net_ipv4_icmp_echo_ignore_broadcasts
          - sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value=enabled
          - sysctl_net_ipv4_icmp_ignore_bogus_error_responses
          - sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value=enabled

    # Section 8: Attack Prevention Mechanisms
    - id: 2.8.1
      title: Network Level and application-level DDoS
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement DDoS protection mechanisms at both network and
          application levels. This may require specialized DDoS mitigation solutions, rate limiting,
          and connection limiting.

    - id: 2.8.2
      title: Excessive Overload Protection
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement controls to protect against resource exhaustion
          attacks. This includes CPU, memory, disk, and network bandwidth protection mechanisms.

    - id: 2.8.3
      title: Manipulated packets protection
      levels:
          - base
      description: |-
          Manipulated packets that are sent to an address of the network device shall not lead to
          an impairment of availability.
      status: automated
      notes: |-
          Kernel parameters help protect against various packet manipulation attacks.
      rules:
          - sysctl_net_ipv4_conf_all_accept_source_route_value=disabled
          - sysctl_net_ipv4_conf_all_accept_redirects_value=disabled
          - sysctl_net_ipv4_tcp_syncookies_value=enabled

    # Section 9: Vulnerability Testing Requirements
    - id: 2.9.1
      title: Fuzzing - Network and Application Level
      levels:
          - base
      description: |-
          TODO: needs a new rule - Perform regular fuzzing tests on network services and
          applications. This is typically a testing requirement rather than a configuration item.

    - id: 2.9.2
      title: Port Scanning
      levels:
          - base
      description: |-
          TODO: needs a new rule - Perform regular port scanning to identify open ports and
          services. This is a testing/audit requirement. Consider using nmap or similar tools.

    - id: 2.9.3
      title: Vulnerability Scanning
      levels:
          - base
      description: |-
          Regular vulnerability scanning shall be performed to identify security weaknesses.
      status: manual
      notes: |-
          This is an operational requirement. Consider using OpenSCAP, Nessus, or similar
          vulnerability scanning tools.
      related_rules:
          - security_patches_up_to_date

    # Section 10: Operating System
    - id: 2.10.1
      title: Growing Content Handling
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement controls to handle growing log files and other content
          that increases over time. Log rotation and disk space monitoring should be configured.

    - id: 2.10.2
      title: Handling of ICMP
      levels:
          - base
      description: |-
          ICMP shall be handled securely to prevent information disclosure and attacks.
      status: automated
      rules:
          - sysctl_net_ipv4_icmp_echo_ignore_broadcasts
          - sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value=enabled
          - sysctl_net_ipv4_icmp_ignore_bogus_error_responses
          - sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value=enabled

    - id: 2.10.3
      title: Authenticated Privilege Escalation only
      levels:
          - base
      description: |-
          Privilege escalation shall only be possible through authenticated mechanisms.
      status: automated
      rules:
          - sudo_require_authentication
          - sudo_require_reauthentication
          - use_pam_wheel_group_for_su

    - id: 2.10.4
      title: System account identification
      levels:
          - base
      description: |-
          System accounts shall be properly identified and secured.
      status: automated
      rules:
          - no_password_auth_for_systemaccounts
          - no_shelllogin_for_systemaccounts

    - id: 2.10.5
      title: OS Hardening - Minimized kernel network functions
      levels:
          - base
      description: |-
          Unnecessary kernel modules shall be disabled.
      status: automated
      rules:
          - kernel_module_cramfs_disabled
          - kernel_module_freevxfs_disabled
          - kernel_module_jffs2_disabled
          - kernel_module_hfs_disabled
          - kernel_module_hfsplus_disabled
          - kernel_module_udf_disabled
          - kernel_module_usb-storage_disabled
          - kernel_module_dccp_disabled
          - kernel_module_sctp_disabled
          - kernel_module_rds_disabled
          - kernel_module_tipc_disabled

    - id: 2.10.6
      title: No automatic launch of removable media
      levels:
          - base
      description: |-
          Removable media shall not be automatically mounted or executed.
      status: automated
      rules:
          - dconf_gnome_disable_automount
          - dconf_gnome_disable_automount_open
          - dconf_gnome_disable_autorun

    - id: 2.10.7
      title: External file system mount restrictions
      levels:
          - base
      description: |-
          Mounting of external file systems shall be restricted.
      status: partial
      notes: |-
          Mount restrictions can be enforced through /etc/fstab options and mount policies.
      rules:
          - mount_option_dev_shm_nodev
          - mount_option_dev_shm_nosuid
          - mount_option_dev_shm_noexec
      related_rules:
          - mount_option_tmp_nodev
          - mount_option_tmp_nosuid
          - mount_option_tmp_noexec

    - id: 2.10.8
      title: File-system Authorization privileges
      levels:
          - base
      description: |-
          File system permissions shall be properly configured to restrict access.
      status: automated
      rules:
          - file_permissions_unauthorized_world_writable
          - dir_perms_world_writable_sticky_bits
          - no_files_unowned_by_user
          - file_permissions_ungroupowned

    - id: 2.10.9
      title: SYN Flood Prevention
      levels:
          - base
      description: |-
          System shall be protected against SYN flood attacks.
      status: automated
      rules:
          - sysctl_net_ipv4_tcp_syncookies
          - sysctl_net_ipv4_tcp_syncookies_value=enabled

    - id: 2.10.10
      title: Handling of IP options and extensions
      levels:
          - base
      description: |-
          TODO: needs a new rule - Configure kernel to properly handle IP options and IPv6
          extensions. Consider disabling unnecessary IP options.

    # Section 11: Web Servers
    - id: 2.11.1
      title: HTTPS
      levels:
          - base
      description: |-
          TODO: needs a new rule - Ensure web services use HTTPS with strong TLS configuration.
          Configure Apache/Nginx to use TLS 1.2 or higher with secure cipher suites.

    - id: 2.11.2
      title: Webserver logging
      levels:
          - base
      description: |-
          TODO: needs a new rule - Configure comprehensive logging for web server access and errors.

    - id: 2.11.3
      title: HTTPS input validation
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement input validation for all HTTP/HTTPS requests to
          prevent injection attacks.

    - id: 2.11.4
      title: No system privileges
      levels:
          - base
      description: |-
          TODO: needs a new rule - Ensure web server processes do not run with system/root
          privileges. Configure Apache/Nginx to run as dedicated non-privileged user.

    - id: 2.11.5
      title: No unused HTTPS methods
      levels:
          - base
      description: |-
          TODO: needs a new rule - Disable unnecessary HTTP methods (TRACE, DELETE, etc.) in web
          server configuration.

    - id: 2.11.6
      title: No unused add-ons
      levels:
          - base
      description: |-
          TODO: needs a new rule - Remove or disable unused web server modules and add-ons.

    - id: 2.11.7
      title: No compiler, interpreter, or shell via CGI
      levels:
          - base
      description: |-
          TODO: needs a new rule - Prevent execution of compilers, interpreters, or shells through
          CGI or server-side scripts.

    - id: 2.11.8
      title: No CGI or other scripting for uploads
      levels:
          - base
      description: |-
          TODO: needs a new rule - Restrict file upload capabilities and prevent execution of
          uploaded files.

    - id: 2.11.9
      title: No execution of system commands with SSI
      levels:
          - base
      description: |-
          TODO: needs a new rule - Disable Server Side Includes (SSI) or restrict exec command in
          SSI.

    - id: 2.11.10
      title: Access rights for web server configuration
      levels:
          - base
      description: |-
          TODO: needs a new rule - Restrict access to web server configuration files to authorized
          administrators only.

    - id: 2.11.11
      title: No default content
      levels:
          - base
      description: |-
          TODO: needs a new rule - Remove default web server content, sample pages, and
          documentation.

    - id: 2.11.12
      title: No directory listings
      levels:
          - base
      description: |-
          TODO: needs a new rule - Disable directory browsing/listings in web server configuration.

    - id: 2.11.13
      title: Web server information in HTTPS headers
      levels:
          - base
      description: |-
          TODO: needs a new rule - Configure web server to minimize information disclosure in HTTP
          headers (remove/obfuscate Server header).

    - id: 2.11.14
      title: Web server information in error pages
      levels:
          - base
      description: |-
          TODO: needs a new rule - Configure custom error pages that don't reveal web server
          version or system information.

    - id: 2.11.15
      title: Minimized file type mappings
      levels:
          - base
      description: |-
          TODO: needs a new rule - Remove unnecessary MIME type mappings from web server
          configuration.

    - id: 2.11.16
      title: Restricted file access
      levels:
          - base
      description: |-
          TODO: needs a new rule - Configure web server to restrict access to sensitive files and
          directories.

    - id: 2.11.17
      title: Execute rights exclusive for CGI/Scripting directory
      levels:
          - base
      description: |-
          TODO: needs a new rule - Restrict execute permissions to designated CGI/script
          directories only.

    - id: 2.11.18
      title: HTTP User session
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement secure session management with proper timeout,
          secure cookies, and session invalidation.

    # Section 12: Other Security requirements
    - id: 2.12.1
      title: Remote Diagnostic Procedure - Verification
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement verification mechanisms for remote diagnostic
          procedures. All remote diagnostic access should be logged and authorized.

    - id: 2.12.2
      title: No System Password Recovery
      levels:
          - base
      description: |-
          System shall not have password recovery mechanisms that bypass authentication.
      status: automated
      notes: |-
          Bootloader password protection helps prevent unauthorized password recovery.
      rules:
          - grub2_password
          - grub2_uefi_password

    - id: 2.12.3
      title: Secure System Software Revocation
      levels:
          - base
      description: |-
          TODO: needs a new rule - Implement mechanism to revoke compromised system software or
          certificates.

    - id: 2.12.4
      title: Software Integrity Check - Installation
      levels:
          - base
      description: |-
          Software integrity shall be verified during installation.
      status: automated
      rules:
          - ensure_gpgcheck_globally_activated
          - ensure_gpgcheck_never_disabled
          - rpm_verify_permissions
          - rpm_verify_ownership

    - id: 2.12.5
      title: Software Integrity Check - Boot
      levels:
          - base
      description: |-
          Software integrity shall be verified during system boot.
      status: partial
      notes: |-
          AIDE and secure boot help verify system integrity. Full implementation requires secure
          boot enablement and regular AIDE checks.
      rules:
          - package_aide_installed
          - aide_build_database
          - aide_periodic_cron_checking
      related_rules:
          - aide_check_audit_tools

    - id: 2.12.6
      title: Unused Physical and Logical Interfaces Disabling
      levels:
          - base
      description: |-
          Unused physical and logical network interfaces shall be disabled.
      status: partial
      notes: |-
          Requires identification of unused interfaces specific to the system.
      rules:
          - wireless_disable_interfaces
          - service_bluetooth_disabled

    - id: 2.12.7
      title: No Default Profile
      levels:
          - base
      description: |-
          System shall not use default configuration profiles.
      status: manual
      notes: |-
          This is a general requirement to customize system configuration. Administrators should
          review and modify default settings according to organizational security policies.

